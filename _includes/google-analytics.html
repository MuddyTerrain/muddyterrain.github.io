{% if jekyll.environment == "production" %}
<script async src="https://www.googletagmanager.com/gtag/js?id={{ site.data.settings.google-ID }}"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  // Function to get a cookie
  function getCookie(name) {
    const nameEQ = name + "=";
    const ca = document.cookie.split(';');
    for(let i=0; i < ca.length; i++) {
      let c = ca[i];
      while (c.charAt(0) === ' ') c = c.substring(1, c.length);
      if (c.indexOf(nameEQ) === 0) return c.substring(nameEQ.length, c.length);
    }
    return null;
  }

  const internalUser = getCookie('internal_user');
  if (internalUser) {
    gtag('config', '{{ site.data.settings.google-ID }}', {
      'traffic_type': 'internal'
    });
  } else {
    gtag('config', '{{ site.data.settings.google-ID }}');
  }
</script>
{% endif %}